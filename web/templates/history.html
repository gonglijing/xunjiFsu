{{ define "history-content" }}
        <!-- æŸ¥è¯¢æ¡ä»¶ -->
        <div class="card">
            <div class="card-header">
        <h3 class="card-title">å†å²æ•°æ®æŸ¥è¯¢</h3>
        <button type="button" class="btn btn-primary" onclick="quickQuery('1h')">æœ€è¿‘1å°æ—¶</button>
            </div>
            
            <form hx-get="/api/data/history" hx-trigger="submit" hx-target="#history-content" class="filter-bar">
                <div class="filter-item">
                    <label class="form-label">è®¾å¤‡</label>
                    <select name="device_id" class="form-select">
                        <option value="">-- æ‰€æœ‰è®¾å¤‡ --</option>
                    </select>
                </div>
                <div class="filter-item">
                    <label class="form-label">å¼€å§‹æ—¶é—´</label>
            <input type="datetime-local" name="start_time" class="form-input" id="start-time">
                </div>
                <div class="filter-item">
                    <label class="form-label">ç»“æŸæ—¶é—´</label>
            <input type="datetime-local" name="end_time" class="form-input" id="end-time">
                </div>
        <div class="filter-item" style="flex:0;">
            <label class="form-label">&nbsp;</label>
            <button type="submit" class="btn btn-primary">
                ğŸ” æŸ¥è¯¢
            </button>
                </div>
            </form>
        </div>
        
        <!-- å†å²æ•°æ®åˆ—è¡¨ -->
        <div id="history-content" hx-get="/api/data/history" hx-trigger="load" hx-target="this">
            <div class="card">
        <div class="chart-container">
            <div class="chart-placeholder">
                <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1">
                    <circle cx="12" cy="12" r="10"/>
                    <path d="M12 6v6l4 2"/>
                </svg>
                    <div>è¯·é€‰æ‹©æŸ¥è¯¢æ¡ä»¶åç‚¹å‡»æŸ¥è¯¢</div>
                </div>
            </div>
        </div>
</div>

    <script>
        // åˆå§‹åŒ–é»˜è®¤æ—¶é—´ä¸ºæœ€è¿‘24å°æ—¶
        document.addEventListener('DOMContentLoaded', function() {
            const now = new Date();
            const yesterday = new Date(now.getTime() - 24 * 60 * 60 * 1000);
            
    const endTimeInput = document.getElementById('end-time');
    const startTimeInput = document.getElementById('start-time');
            
            if (endTimeInput && startTimeInput) {
                endTimeInput.value = now.toISOString().slice(0, 16);
                startTimeInput.value = yesterday.toISOString().slice(0, 16);
            }
        });

// å¿«æ·æŸ¥è¯¢
function quickQuery(range) {
    const now = new Date();
    let start = new Date();
    
    switch(range) {
        case '1h':
            start.setHours(start.getHours() - 1);
            break;
        case '6h':
            start.setHours(start.getHours() - 6);
            break;
        case '24h':
            start.setDate(start.getDate() - 1);
            break;
        case '7d':
            start.setDate(start.getDate() - 7);
            break;
    }
    
    document.getElementById('end-time').value = now.toISOString().slice(0, 16);
    document.getElementById('start-time').value = start.toISOString().slice(0, 16);
    
    // è§¦å‘æŸ¥è¯¢
    htmx.trigger(htmx.find('#history-content'), 'load');
}
    </script>
{{ end }}
